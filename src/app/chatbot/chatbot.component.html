<!-- Chatbot Container -->
<div class="fixed bottom-6 right-6 z-50 font-poppins">
  <!-- Chat Window -->
  <div
    *ngIf="isOpen"
    [class.minimized]="isMinimized"
    class="chat-window bg-white rounded-2xl shadow-2xl mb-4 overflow-hidden transition-all duration-300 ease-in-out"
    [ngClass]="isMinimized ? 'h-16' : 'h-[600px]'"
  >
    <!-- Chat Header -->
    <div
      class="chat-header bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-4 flex items-center justify-between cursor-pointer"
    >
      <div class="flex items-center space-x-3">
        <div class="relative">
          <div
            class="w-10 h-10 bg-white rounded-full flex items-center justify-center"
          >
            <span class="text-2xl">ðŸ¤–</span>
          </div>
          <span
            class="absolute bottom-0 right-0 w-3 h-3 bg-green-400 border-2 border-white rounded-full"
          ></span>
        </div>
        <div>
          <h3 class="font-semibold text-sm">Support Assistant</h3>
          <p class="text-xs text-blue-100">Online</p>
        </div>
      </div>
      <div class="flex items-center space-x-2">
        <button
          (click)="minimizeChat()"
          class="hover:bg-white hover:bg-opacity-20 rounded-full p-2 transition-all duration-200"
        >
          <svg
            *ngIf="!isMinimized"
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M20 12H4"
            />
          </svg>
          <svg
            *ngIf="isMinimized"
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M5 15l7-7 7 7"
            />
          </svg>
        </button>
        <button
          (click)="closeChat()"
          class="hover:bg-white hover:bg-opacity-20 rounded-full p-2 transition-all duration-200"
        >
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"
            />
          </svg>
        </button>
      </div>
    </div>

    <!-- Chat Messages -->
    <div
      *ngIf="!isMinimized"
      class="chat-messages h-[460px] overflow-y-auto p-4 bg-gray-50"
    >
      <div *ngFor="let message of messages" class="mb-4 animate-fadeIn">
        <!-- Bot Message -->
        <div
          *ngIf="message.sender === 'bot'"
          class="flex items-start space-x-2"
        >
          <div
            class="w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-500 rounded-full flex items-center justify-center flex-shrink-0"
          >
            <span class="text-white text-sm">ðŸ¤–</span>
          </div>
          <div class="flex flex-col max-w-[75%]">
            <div class="bg-white rounded-2xl rounded-tl-sm px-4 py-2 shadow-sm">
              <p class="text-gray-800 text-sm">{{ message.text }}</p>
            </div>
            <span class="text-xs text-gray-400 mt-1 ml-2">{{
              message.timestamp | date : "shortTime"
            }}</span>
          </div>
        </div>

        <!-- User Message -->
        <div
          *ngIf="message.sender === 'user'"
          class="flex items-start space-x-2 justify-end"
        >
          <div class="flex flex-col items-end max-w-[75%]">
            <div
              class="bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl rounded-tr-sm px-4 py-2 shadow-sm"
            >
              <p class="text-white text-sm">{{ message.text }}</p>
            </div>
            <span class="text-xs text-gray-400 mt-1 mr-2">{{
              message.timestamp | date : "shortTime"
            }}</span>
          </div>
          <div
            class="w-8 h-8 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center flex-shrink-0"
          >
            <span class="text-white text-sm">ðŸ‘¤</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Chat Input -->
    <div
      *ngIf="!isMinimized"
      class="chat-input border-t border-gray-200 p-4 bg-white"
    >
      <div class="flex items-center space-x-2">
        <button
          class="hidden text-gray-400 hover:text-blue-600 transition-colors duration-200"
          aria-hidden="true"
          tabindex="-1"
        >
          <svg
            class="w-6 h-6"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
            />
          </svg>
        </button>
        <input
          type="text"
          [(ngModel)]="messageText"
          (keypress)="handleKeyPress($event)"
          placeholder="Type a message..."
          class="flex-1 px-4 py-2 bg-gray-100 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"
        />
        <button
          (click)="sendMessage()"
          [disabled]="!messageText.trim()"
          class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-2 rounded-full hover:from-blue-700 hover:to-indigo-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
        >
          <svg
            class="w-5 h-5 transform rotate-90"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"
            />
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Chat Toggle Button -->
  <button
    *ngIf="!isOpen"
    (click)="toggleChat()"
    class="chat-toggle-btn bg-gradient-to-r from-blue-600 to-indigo-600 text-white w-16 h-16 rounded-full shadow-2xl hover:shadow-3xl transition-all duration-300 flex items-center justify-center hover:scale-110 active:scale-95"
  >
    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"
      />
    </svg>
  </button>
</div>
